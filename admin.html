<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>ADMIN â€“ Ngá»c Becon</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
:root{--pink:#ff4fa3}
*{box-sizing:border-box;font-family:Segoe UI,Arial}
body{margin:0;background:radial-gradient(circle,#3a0045,#0b0010);color:#fff}
header{
background:linear-gradient(90deg,#ff4fa3,#ff77b7);
padding:16px;text-align:center;font-size:20px;font-weight:bold
}
.card{background:#16001d;padding:20px;border-radius:20px;margin:20px}
h2{margin:0 0 10px}
table{width:100%;border-collapse:collapse}
th,td{padding:10px;border-bottom:1px solid #333;font-size:14px}
button{
padding:6px 12px;border:none;border-radius:10px;
background:var(--pink);color:#fff;font-weight:bold;cursor:pointer
}
.danger{background:#ff3b3b}
.small{font-size:12px;color:#ffb6d9}
</style>
</head>

<body>

<header>ğŸ” ADMIN NGá»ŒC BECON</header>

<!-- USERS -->
<div class="card">
<h2>ğŸ‘¤ NgÆ°á»i dÃ¹ng</h2>
<table>
<tr><th>User</th><th>Sá»‘ dÆ°</th><th>HÃ nh Ä‘á»™ng</th></tr>
<tbody id="userList"></tbody>
</table>
</div>

<!-- TOPUP -->
<div class="card">
<h2>ğŸ’³ Náº¡p tiá»n chá» duyá»‡t</h2>
<table>
<tr>
<th>User</th><th>Loáº¡i</th><th>Sá»‘ tiá»n</th><th>Chi tiáº¿t</th><th>HÃ nh Ä‘á»™ng</th>
</tr>
<tbody id="topupList"></tbody>
</table>
</div>

<!-- ORDERS -->
<div class="card">
<h2>ğŸ“¦ ÄÆ¡n cÃ y thuÃª</h2>
<table>
<tr>
<th>User</th><th>Game</th><th>GÃ³i</th><th>GiÃ¡</th><th>HÃ nh Ä‘á»™ng</th>
</tr>
<tbody id="orderList"></tbody>
</table>
</div>

<script>
let DB = JSON.parse(localStorage.getItem("SHOP_DB")) || {
  users:{}, orders:[], topups:[]
}

function save(){
  localStorage.setItem("SHOP_DB",JSON.stringify(DB))
  render()
}

/* ========== USERS ========== */
function renderUsers(){
  userList.innerHTML=""
  Object.keys(DB.users).forEach(u=>{
    let tr=document.createElement("tr")
    tr.innerHTML=`
      <td>${u}</td>
      <td>${DB.users[u].money}Ä‘</td>
      <td>
        <button onclick="addMoney('${u}',10000)">+10k</button>
        <button onclick="addMoney('${u}',-10000)">-10k</button>
      </td>`
    userList.appendChild(tr)
  })
}

function addMoney(user,amount){
  DB.users[user].money+=amount
  notify(user,`ğŸ’° Sá»‘ dÆ° ${amount>0?'+':''}${amount}Ä‘`)
  save()
}

/* ========== TOPUP ========== */
function renderTopups(){
  topupList.innerHTML=""
  DB.topups.filter(t=>t.status==="pending").forEach(t=>{
    let detail="KhÃ´ng cÃ³"

    if(t.type==="CARD" && t.detail){
      detail=`
      <div class="small">
        ğŸ“¶ ${t.detail.telco}<br>
        ğŸ”¢ Seri: ${t.detail.seri}<br>
        ğŸ” MÃ£: ${t.detail.code}
      </div>`
    }

    if(t.type==="MOMO"){
      detail=`<div class="small">ğŸ’— MoMo chuyá»ƒn khoáº£n</div>`
    }

    let tr=document.createElement("tr")
    tr.innerHTML=`
      <td>${t.user}</td>
      <td>${t.type}</td>
      <td>${t.amount}</td>
      <td>${detail}</td>
      <td>
        <button onclick="approveTopup(${t.id})">Duyá»‡t</button>
        <button class="danger" onclick="rejectTopup(${t.id})">Tá»« chá»‘i</button>
      </td>`
    topupList.appendChild(tr)
  })
}

function approveTopup(id){
  let t=DB.topups.find(x=>x.id===id)
  if(!t)return
  DB.users[t.user].money+=t.amount
  t.status="done"
  notify(t.user,`ğŸ’³ Náº¡p ${t.type} +${t.amount}Ä‘ thÃ nh cÃ´ng`)
  save()
}

function rejectTopup(id){
  let t=DB.topups.find(x=>x.id===id)
  if(!t)return
  t.status="reject"
  notify(t.user,`âŒ Náº¡p ${t.type} ${t.amount}Ä‘ bá»‹ tá»« chá»‘i`)
  save()
}

/* ========== ORDERS ========== */
function renderOrders(){
  orderList.innerHTML=""
  DB.orders.filter(o=>o.status==="pending").forEach(o=>{
    let tr=document.createElement("tr")
    tr.innerHTML=`
      <td>${o.user}</td>
      <td>${o.game}</td>
      <td>${o.pack}</td>
      <td>${o.price}</td>
      <td>
        <button onclick="approveOrder(${o.id})">HoÃ n thÃ nh</button>
        <button class="danger" onclick="rejectOrder(${o.id})">Há»§y</button>
      </td>`
    orderList.appendChild(tr)
  })
}

function approveOrder(id){
  let o=DB.orders.find(x=>x.id===id)
  if(!o)return
  o.status="done"
  notify(o.user,`ğŸ“¦ ÄÆ¡n ${o.game} Ä‘Ã£ hoÃ n thÃ nh`)
  save()
}

function rejectOrder(id){
  let o=DB.orders.find(x=>x.id===id)
  if(!o)return
  o.status="reject"
  notify(o.user,`âŒ ÄÆ¡n ${o.game} Ä‘Ã£ bá»‹ há»§y`)
  save()
}

/* ========== NOTIFY ========== */
function notify(user,text){
  if(!DB.users[user].notifications)
    DB.users[user].notifications=[]
  DB.users[user].notifications.push({
    text,
    time:new Date().toLocaleString(),
    read:false
  })
}

/* ========== RENDER ========== */
function render(){
  renderUsers()
  renderTopups()
  renderOrders()
}
render()
</script>

</body>
</html>
