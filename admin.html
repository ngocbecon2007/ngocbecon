<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Admin Ngá»c Becon</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
*{box-sizing:border-box;font-family:Segoe UI}
body{margin:0;background:#0b0010;color:#fff;height:100vh;display:flex}
.hidden{display:none}
.left{width:260px;background:#16001d;overflow:auto}
.left h3{padding:12px;margin:0;border-bottom:1px solid #333}
.left div{padding:10px;border-bottom:1px solid #333;cursor:pointer}
.left div:hover{background:#22002b}
.main{flex:1;display:flex;flex-direction:column}
.header{padding:12px;background:linear-gradient(90deg,#ff4fa3,#ff77b7)}
.content{flex:1;overflow:auto;padding:10px}
.card{background:#16001d;padding:12px;border-radius:14px;margin-bottom:10px}
.msg{margin:6px 0}
.user{text-align:left}
.admin{text-align:right}
.bubble{display:inline-block;padding:8px 12px;border-radius:16px;max-width:70%}
.user .bubble{background:#333}
.admin .bubble{background:#ff4fa3}
.input{display:flex;gap:6px;padding:8px}
.input input{flex:1;padding:10px;border-radius:999px;border:none}
.input button{border:none;border-radius:50%;width:36px;height:36px;background:#ff4fa3;color:#fff}
</style>
</head>
<body>

<!-- LOGIN -->
<div id="login" class="main">
<div class="header"><b>ADMIN LOGIN</b></div>
<div class="content">
<input id="u" placeholder="admin" style="width:100%;padding:12px">
<input id="p" type="password" placeholder="máº­t kháº©u" style="width:100%;padding:12px;margin-top:10px">
<button style="width:100%;padding:12px;margin-top:10px"
onclick="login()">ÄÄƒng nháº­p</button>
</div>
</div>

<!-- ADMIN -->
<div id="admin" class="hidden" style="width:100%;display:flex">
<div class="left">
<h3>ğŸ‘¥ NgÆ°á»i dÃ¹ng</h3>
<div id="userList"></div>

<h3>ğŸ’³ Náº¡p tiá»n</h3>
<div id="napList"></div>

<h3>ğŸ“¦ ÄÆ¡n hÃ ng</h3>
<div id="orderList"></div>
</div>

<div class="main">
<div class="header">
CSKH Ngá»c Becon ğŸ° <span id="curUser"></span>
</div>

<div class="content" id="chatBox"></div>

<div class="input">
<input id="msg" placeholder="Nháº¯n admin...">
<button onclick="send()">â¤</button>
</div>
</div>
</div>

<script>
let ADMIN={u:"admin",p:"admin123"}
let curUser=null

function login(){
if(u.value===ADMIN.u && p.value===ADMIN.p){
 login.classList.add("hidden")
 admin.classList.remove("hidden")
 localStorage.setItem("CSKH_ONLINE","1")
 loadUsers();loadNap();loadOrder()
}else alert("Sai admin")
}

onbeforeunload=()=>localStorage.setItem("CSKH_ONLINE","0")

function loadUsers(){
userList.innerHTML=""
Object.keys(localStorage).filter(k=>k.startsWith("CHAT_"))
.forEach(k=>{
let u=k.replace("CHAT_","")
userList.innerHTML+=`<div onclick="openChat('${u}')">ğŸ’¬ ${u}</div>`
})
}

function openChat(u){
curUser=u
curUserSpan=curUser
curUserLabel()
loadChat()
}

function curUserLabel(){
curUserSpan=document.getElementById("curUser")
curUserSpan.innerText=curUser?`â€“ ${curUser}`:""
}

function loadChat(){
chatBox.innerHTML=""
let c=JSON.parse(localStorage.getItem("CHAT_"+curUser))||[]
c.forEach(m=>{
let d=m.type=="img"?`<img src="${m.data}" style="max-width:150px">`:m.text
chatBox.innerHTML+=`<div class="msg ${m.from}">
<div class="bubble">${d}</div></div>`
})
chatBox.scrollTop=9999
}

function send(){
if(!curUser||!msg.value)return
let c=JSON.parse(localStorage.getItem("CHAT_"+curUser))||[]
c.push({from:"admin",type:"text",text:msg.value})
localStorage.setItem("CHAT_"+curUser,JSON.stringify(c))
msg.value=""
loadChat()
}

function loadNap(){
napList.innerHTML=""
let n=JSON.parse(localStorage.getItem("NAP"))||[]
n.forEach((x,i)=>{
napList.innerHTML+=`
<div class="card">
<b>${x.user}</b> â€“ ${x.money}Ä‘
<button onclick="okNap(${i})">âœ”</button>
</div>`
})
}

function okNap(i){
let n=JSON.parse(localStorage.getItem("NAP"))
let u=n[i].user
let db=JSON.parse(localStorage.getItem("SHOP"))
db.users[u].money+=Number(n[i].money)
localStorage.setItem("SHOP",JSON.stringify(db))
n.splice(i,1)
localStorage.setItem("NAP",JSON.stringify(n))
loadNap()
alert("ÄÃ£ duyá»‡t")
}

function loadOrder(){
orderList.innerHTML=""
let o=JSON.parse(localStorage.getItem("ORDER"))||[]
o.forEach((x,i)=>{
orderList.innerHTML+=`
<div class="card">
<b>${x.user}</b><br>${x.name}
<button onclick="doneOrder(${i})">HoÃ n thÃ nh</button>
</div>`
})
}

function doneOrder(i){
let o=JSON.parse(localStorage.getItem("ORDER"))
o.splice(i,1)
localStorage.setItem("ORDER",JSON.stringify(o))
loadOrder()
}
</script>
</body>
</html>
